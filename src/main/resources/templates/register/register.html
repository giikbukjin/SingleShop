<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Shopping Mall</title>
  <!-- 아이콘 -->
  <link rel="icon" type="image/png" sizes="16x16" href="/images/elice-rabbit-favicon.png"/>
  <!-- bulma css 관련 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css"/>
  <!-- 폰트 어썸: 아이콘 -->
  <script defer src="https://kit.fontawesome.com/9daa42bcef.js" crossorigin="anonymous"></script>
  <!-- 커스텀 css, js -->
  <link rel="stylesheet" href="/css/register.css"/>
  <script src="/js/register.js" type="module" defer></script>
</head>
<body>
<nav class="navbar" role="navigation" aria-label="main navigation">
  <!-- Navbar content here -->
</nav>

<!-- 회원가입 폼(Form) -->
<div class="register-user-form-container">
  <form class="box register-user-form-box" id="registerUserForm" th:action="@{/auth/signup}" method="post" th:object="${signup}">
    <p class="title is-5 has-text-primary">환영합니다!</p>
    <div class="field">
      <label class="label" for="fullNameInput">이름</label>
      <div class="control">
        <input class="input" id="fullNameInput" type="text" placeholder="유재석" autocomplete="on" th:field="*{name}"/>
        <p class="help is-danger" id="nameErrorMessage"></p> <!-- 이름 오류 메시지 -->
      </div>
    </div>

    <div class="field">
      <label class="label" for="emailInput">이메일</label>
      <div class="control">
        <input class="input" id="emailInput" type="email" placeholder="abc@example.com" autocomplete="on" th:field="*{email}"/>
        <p class="help is-danger" id="emailErrorMessage"></p> <!-- 이메일 오류 메시지 -->
      </div>
    </div>

    <div class="field">
      <label class="label" for="passwordInput">비밀번호</label>
      <div class="control">
        <input class="input" id="passwordInput" type="password" placeholder="********" autocomplete="off" th:field="*{password}"/>
        <p class="help is-danger" id="passwordErrorMessage"></p> <!-- 비밀번호 오류 메시지 -->
      </div>
    </div>

    <div class="field mb-5">
      <label class="label" for="passwordConfirmInput">비밀번호 확인</label>
      <div class="control">
        <input class="input" id="passwordConfirmInput" type="password" placeholder="********" autocomplete="off"/>
        <p class="help is-danger" id="confirmPasswordErrorMessage"></p> <!-- 비밀번호 확인 오류 메시지 -->
      </div>
    </div>

    <button class="button is-primary is-fullwidth" id="submitButton" type="submit">회원가입하기</button>
  </form>
</div>

<script>
  document.getElementById('registerUserForm').addEventListener('submit', function(event) {
    const nameInput = document.getElementById('fullNameInput');
    const emailInput = document.getElementById('emailInput');
    const passwordInput = document.getElementById('passwordInput');
    const passwordConfirmInput = document.getElementById('passwordConfirmInput');
    const nameErrorMessage = document.getElementById('nameErrorMessage');
    const emailErrorMessage = document.getElementById('emailErrorMessage');
    const passwordErrorMessage = document.getElementById('passwordErrorMessage');
    const confirmPasswordErrorMessage = document.getElementById('confirmPasswordErrorMessage');
    let isValid = true;

    // 이름 길이 유효성 검사 (5자 이상, 15자 이하)
    if (nameInput.value.length < 5 || nameInput.value.length > 15) {
      nameErrorMessage.textContent = '이름은 5자 이상, 15자 이하로 입력해주세요.';
      isValid = false;
    } else {
      nameErrorMessage.textContent = '';
    }

    // 이메일 형식 유효성 검사
    if (!isValidEmail(emailInput.value)) {
      emailErrorMessage.textContent = '올바른 이메일 형식이 아닙니다.';
      isValid = false;
    } else {
      emailErrorMessage.textContent = '';
    }

    // 비밀번호 유효성 검사 (최소 6자 이상)
    if (passwordInput.value.length < 6) {
      passwordErrorMessage.textContent = '비밀번호는 최소 6자 이상이어야 합니다.';
      isValid = false;
    } else {
      passwordErrorMessage.textContent = '';
    }

    // 비밀번호 확인 일치 여부 확인
    if (passwordInput.value !== passwordConfirmInput.value) {
      confirmPasswordErrorMessage.textContent = '비밀번호가 일치하지 않습니다.';
      isValid = false;
    } else {
      confirmPasswordErrorMessage.textContent = '';
    }

    // 폼 제출 방지
    if (!isValid) {
      event.preventDefault();
    }
  });

  // 이메일 형식 검사 함수
  function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
  }
</script>

</body>
</html>
